<mat-accordion>
  @for (game of games(); track game.title) {
    <mat-expansion-panel (closed)="onClosePanel(game.title)">
      <mat-expansion-panel-header>
        <mat-panel-title> {{ game.title }} </mat-panel-title>
        <mat-panel-description> {{ getWinnerName(game.title) }} </mat-panel-description>
      </mat-expansion-panel-header>

      <div class="player-selects">
        @for (player of players(); track player.name) {
          <div class="player-select">
            <label>{{ player.name }}</label>
            <mat-form-field appearance="outline" subscriptSizing="dynamic">
              <mat-select
                [formControl]="getControl(game.title, player.name)"
                [errorStateMatcher]="matcher"
              >
                @for (option of selectOptions(); track option) {
                  <mat-option [value]="option">{{ option }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>
        }
      </div>

      <mat-action-row>
        <button
          matButton
          (click)="onClickUpdateResults(game.title)"
          [disabled]="rankingsForm.get(game.title)?.invalid"
        >
          Update rankings
        </button>
        <button matButton (click)="onRemoveGame(game.title)">Delete game</button>
      </mat-action-row>
    </mat-expansion-panel>
  }
</mat-accordion>
